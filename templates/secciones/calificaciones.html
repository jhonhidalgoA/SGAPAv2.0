{% extends "main.html" %}
{% include "components/modal.html" %}
{% from "macros/buttons.j2" import btn with context %}
{% block title %} M. DOCENTE | SGAPA{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/calificaciones.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <div class="header">
        <div class="icon__return">
            <a href="{{ url_for('dashboards.docente') }}" class="icon__link">
                <i class="material-symbols-outlined" aria-label="Table">arrow_back</i>
            </a>
        </div>
        <div class="title">
            <div class="row__title">
                <i class="material-symbols-outlined">edit_note</i>
                <h1>Calificaciones</h1>
            </div>
            <p>Sistema de Gestión Administrativa y Procesos Académicos (SGAPA) </p>
        </div>
        <div class="navbar__logo">
            <span onclick="showModal('', '¿Estás seguro de que deseas cerrar sesión?', confirmLogout)"
                class="icon material-symbols-outlined toggleBtn">
                logout
            </span>
        </div>
    </div>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
    <script>
        showModal("{{ category | title }}", "{{ message | safe}}", null);
    </script>
    {% endfor %}
    {% endif %}
    {% endwith %}
    <form action="{{ url_for('secciones.guardar_notas') }}" method="POST" id="form-notas">
    <div class="ratings__group">
        <div class="group">
            <label for="grados-select">Grupo:</label>
            <select id="grados-select" name="grados" aria-label="Selecciona un grado">
                <option value="">Seleccionar</option>
                <option value="6">Grado Sexto </option>
                <option value="7">Grado Séptimo</option>
                <option value="8">Grado Octavo</option>
                <option value="8">Grado Noveno</option>
                <option value="10">Grado Décimo</option>
                <option value="11">Grado Undécimo</option>
            </select>
        </div>
        <div class="subjects">
            <label for="asignatura-select">Asignatura:</label>
            <select id="asignatura-select" name="grados" aria-label="Selecciona una asignatura">
                <option value="">Seleccionar</option>
                <option value="1">Matemáticas</option>
                <option value="2">Castellano</option>
                <option value="3">Tecnología</option>
                <option value="4">Ética</option>
                <option value="5">Artistica</option>
            </select>
        </div>
        <div class="period">
            <label for="periodos-select">Periodo:</label>
            <select id="periodos-select" name="periodos" aria-label="Selecciona un Periodo">
                <option value="">Seleccionar</option>
                <option value="1">Primero</option>
                <option value="2">Segundo</option>
                <option value="3">Tercero</option>
                <option value="4">Cuarto</option>
            </select>
        </div>
    </div>
    <div class="ratings__buttons">
        {{ btn(icono="add", texto="Cargar", color="load", id="btn-cargar") }}        
        {{ btn(icono="save", texto="Guardar", color="save", id="btn-guardar") }}            
        {{ btn(icono="eye_tracking ", texto="Ver Notas", color="view") }}
    </div>
    <div id="alerta" class="alerta"></div>
    <div class="table-container">
        <table id="tabla-calificaciones" class="tabla-editable">
            <thead>
                <tr>
                    <th>Apellidos</th>
                    <th>Nombres</th>
                    <th>Nota 1</th>
                    <th>Nota 2</th>
                    <th>Nota 3</th>
                    <th>Nota 4</th>
                    <th>Nota 5</th>
                    <th>Nota Final</th>
                </tr>
            </thead>
            <tbody id="tabla-cuerpo">
                <!-- Aquí se insertan las filas dinámicamente -->
            </tbody>
        </table>
    </div>
    </form>
</div>

{% block extra_js %}
<script>   
    function confirmLogout() {
        window.location.href = "{{ url_for('auth.logout') }}";
    }

    function showModal(title, message, action) {
        document.getElementById("modalTitle").innerText = title;
        document.getElementById("modalMessage").innerText = message;
        window.modalAction = action;

        const modal = document.getElementById("confirmModal");
        modal.style.display = "flex";
    }
    document.getElementById("modalConfirm").addEventListener("click", function () {
        if (typeof modalAction === 'function') {
            modalAction();
        }
        document.getElementById("confirmModal").style.display = "none";
    });

    document.getElementById("modalCancel").addEventListener("click", function () {
        document.getElementById("confirmModal").style.display = "none";
    });
</script>
<script src="{{ url_for('static', filename='js/calificaciones.js') }}"></script>

{% endblock %}

{% endblock %}